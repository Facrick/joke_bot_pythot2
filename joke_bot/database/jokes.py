class JokeDatabase:
    def __init__(self):
        self.jokes = []
        self.categories_jokes = {}  # Словарь для хранения шуток по категориям
        self._initialize_jokes()

    def _initialize_jokes(self):
        """Инициализация шуток по категориям"""

        # Категория: Инвалиды и физические особенности
        disability_jokes = [
            "Как называют человека, который продал свою печень? Обеспеченный.",
            "Почему шутить можно над всеми, кроме безногих? Шутки про них обычно не заходят.",
            "Почему безногий боится гопников? Не может постоять за себя.",
            "Что сказал слепой, войдя в бар? 'Всем привет, кого не видел'.",
            "Почему инвалиды-колясочники не играют в прятки? Их всегда находят.",
            "Что сказал безрукий, когда увидел красивую девушку? Хочу потрогать... ой.",
            "Почему слепой не смотрит порно? Не видит в этом смысла.",
            "Как слепой понимает, что помыл всю посуду? Когда перестает резать руки.",
            "Почему глухой не любит слушать анекдоты? Не слышит юмора.",
            "Что общего между инвалидной коляской и лифтом? Оба поднимают настроение.",
            "Из-за чего порвался косоглазый? Пошел куда глаза глядят.",
            "Почему среди немых не популярен БДСМ? У них нет стоп слова.",
            "Почему карлики хорошие детективы? Они могут работать под прикрытием.",
        ]

        # Категория: Смерть, некрофилия и кладбище
        death_jokes = [
            "Чего общего у некрофила и владельца строительной кампании? Они оба имеют недвижимость.",
            "Что говорят про некрофила-зануду? За**ет мертвого.",
            "Почему некрофил плохой любовник? Всегда засыпает после секса.",
            "Что сказал некрофил на свидании? Ты просто мертвая красотка!",
            "Почему на кладбище так тихо? Потому что все жильцы приличные.",
            "Что общего у гроба и шкафа? В обоих кто-то висит.",
            "Почему покойники не пользуются соцсетями? Потому что у них нет статуса.",
            "Что сказал гробовщик своей жене? Ты — любовь всей моей жизни.",
            "Почему утопленники такие спокойные? Их уже ничто не волнует.",
        ]

        # Категория: Болезни и медицина
        medicine_jokes = [
            "Почему в Африке так много болезней? Потому что таблетки нужно запивать водой.",
            "Почему рак — самая вежливая болезнь? Всегда предупреждает о своем визите.",
            "Что сказал врач больному раком? У вас есть полгода... чтобы оплатить счет.",
            "Почему ВИЧ-инфицированные хорошие lovers? Они всегда предохраняются.",
            "Что сказал врач неудачнику? У вас все симптомы жизни.",
            "Как называется диета для анорексичек? Последнее ужинание.",
        ]

        # Категория: Наркотики и алкоголь
        drugs_jokes = [
            "Почему наркоманы могут получить Нобелевскую премию по физике? Они знают как измерять скорость в граммах.",
            "Как называется притон наркоманов-закладчиков? Клуб весёлых и находчивых.",
            "Почему алкоголики не пользуются навигатором? Все дороги ведут в магазин.",
            "Почему бомжи не боятся кризиса? У них и так все плохо.",
            "Что сказал бездомный, когда нашел работу? Наконец-то будет где ночевать!",
        ]

        # Категория: Национальности и расы
        nationality_jokes = [
            "Как называют черную женщину сделавшую 6 абортов? Борец с преступностью.",
            "Почему Буратино хочет на Кавказ? Потому что там могут вырезать семью.",
            "Почему среди фигуристов, не бывает цыган? Никто не верит что это их конёк.",
            "Почему цыган не отправляют на олимпиаду? Они заберут все золото.",
            "Почему евреи не делают репосты? У них нет кнопки поделиться.",
            "Почему евреи не играют в прятки? Потому что никто не ищет бесплатно.",
            "Что сказал цыган, когда увидел работу мечты? 'Это моя работа!'",
        ]

        # Категория: Секс и отношения
        sex_jokes = [
            "Почему толстых женщин не берут в стриптиз? Они перегибают палку.",
            "Зачем скачивать порно-ролик с карликом? Он занимает меньше места.",
            "Как называется избушка Бабы-Яги лесбиянки? Лисбушка.",
            "Как предотвратить инцест у грибов? Фразой 'Не спорь с матерью!'",
            "Нервный альпинист время от времени срывается на свою жену.",
            "Почему разведенные мужчины живут дольше? Потому что жена не может их достать.",
            "Что сказал муж жене после 20 лет брака? Я бы умер за тебя... но не сейчас.",
            "Почему теща — как граната? Выдерни чеку — и семье конец.",
        ]

        # Категория: Политика
        politics_jokes = [
            "Почему политики не тонут? Потому что у них руки по локоть в народном кармане.",
            "Что общего у политика и подгузника? Оба нужно менять регулярно.",
            "Почему депутаты не играют в русскую рулетку? Слишком большой шанс выжить.",
        ]

        # Категория: Абсурд и чёрный юмор
        absurd_jokes = [
            "-Алло, это Чешская Республика? Почешите мне спинку.",
            "В чем разница между землей и нашими шутками? Земля не плоская.",
            "Чего общего у наших шуток и почты России? Не до всех доходит.",
            "Почему Гитлер не любил печь пироги? Ему вечно не хватало яиц.",
            "Почему самоубийцы всегда опаздывают? Потому что у них вечно нет времени.",
            "Что сказал садист-оптимист? Полстакана уже пытали!",
            "Почему маньяк не любит шопинг? Всегда приходится возвращаться за покупками.",
            "Что сказал маньяк-перфекционист? Убивать нужно качественно, а не количественно.",
            "Почему старики не играют в квиддич? Потому что метла — это уже достижение.",
            "Что сказал 90-летний на свидании? Я не обещаю, что доживу до второго.",
            "Почему в доме престарелых нет Wi-Fi? Старики все равно не помнят пароль.",
            "Почему веганы такие грустные? Потому что едят только растения, а они не кричат.",
            "Что сказал каннибал про вегетарианца? Безвкусно, но полезно.",
            "Почему диетическая кола убивает? Потому что жизнь — это не диета.",
            "Почему призраки плохие любовники? Всегда исчезают после первого раза.",
            "Что сказал сатана на собеседовании? У меня горячий стаж.",
            "Почему зомби не пользуются Tinder? Все matches уже мертвы.",
            "Чем отличается оптимист от пессимиста? Оптимист считает, что этот мир лучший из возможных. Пессимист боится, что так и есть.",
            "Почему историки хорошие в постели? Потому что они любят раскопки.",
            "Что сказал однояйцевый близнец на похоронах брата? Теперь я один в ответе за всё.",
            "Как называется группа поддержки для самоубийц? Последний круг.",
            "Почему лунатики живут дольше? Они экономят на сне.",
            "Почему вампиры не пьют алкоголь? Кровь с утра и так бьет в голову.",
            "Почему привидения не женятся? Боятся обязательств на всю оставшуюся смерть.",
        ]

        # Категория: Программирование
        programming_jokes = [
            "Почему программисты путают Хэллоуин и Рождество? Потому что Oct 31 == Dec 25!",
            "Как называют программиста, который боится женщин? SQL инъекция.",
            "Почему Python стал таким популярным? Потому что у него нет проблем с отступами!",
            "Сколько программистов нужно, чтобы вкрутить лампочку? Ни одного, это hardware проблема!",
            "Почему Java разработчики носят очки? Потому что они не C#!",
            "Почему программисты мрут молодыми? Жизнь — это баг, а смерть — фича.",
        ]

        # Сохраняем шутки по категориям
        self.categories_jokes = {
            'Инвалиды': disability_jokes,
            'Смерть': death_jokes,
            'Медицина': medicine_jokes,
            'Наркотики': drugs_jokes,
            'Национальности': nationality_jokes,
            'Секс': sex_jokes,
            'Политика': politics_jokes,
            'Абсурд': absurd_jokes,
            'Программирование': programming_jokes
        }

        # Объединяем все шутки в один список
        for category_jokes in self.categories_jokes.values():
            self.jokes.extend(category_jokes)

    def get_random_joke(self):
        import random
        return random.choice(self.jokes)

    def get_random_joke_by_category(self, category):
        import random
        if category in self.categories_jokes:
            return random.choice(self.categories_jokes[category])
        return None

    def get_categories(self):
        return list(self.categories_jokes.keys())

    def add_joke(self, joke_text, category=None):
        """Добавить новую шутку (можно указать категорию)"""
        self.jokes.append(joke_text)
        if category and category in self.categories_jokes:
            self.categories_jokes[category].append(joke_text)
        return True

    def get_jokes_count(self):
        return len(self.jokes)

    def get_category_stats(self):
        """Получить статистику по категориям"""
        return {category: len(jokes) for category, jokes in self.categories_jokes.items()}

    def get_jokes_by_keyword(self, keyword):
        """Найти шутки по ключевому слову"""
        keyword = keyword.lower()
        return [joke for joke in self.jokes if keyword in joke.lower()]